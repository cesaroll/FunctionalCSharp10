using System.Runtime.InteropServices;
using System.Security.Permissions;

namespace Models.Common;

public static class ToCode39
{
    public static IEnumerable<int> ToCode39Bars(this string value) =>
        ("*" + value + "*").Encode();

    private static IEnumerable<int> Encode(this IEnumerable<char> values) =>
        values.SelectMany(Encode);

    private static int[] Encode(char value) => Code[value];

    private static IDictionary<char, int[]> Code {get;} = new Dictionary<char, int[]>()
    {
        {'1', new[] {2,1,0,1,1,2}},
        {'2', new[] {1,2,0,1,1,2}},
        {'3', new[] {2,2,1,1,2,1,1,1,1}},
        {'4', new[] {1,1,2,1,2,1,1,1,1}},
        {'5', new[] {2,1,2,1,2,1,1,1,1}},
        {'6', new[] {1,2,2,1,2,1,1,1,1}},
        {'7', new[] {1,1,1,2,2,1,1,1,1}},
        {'8', new[] {2,1,1,2,2,1,1,1,1}},
        {'9', new[] {1,2,1,2,2,1,1,1,1}},
        {'0', new[] {1,1,2,2,2,1,1,1,1}},
        {'A', new[] {2,1,1,1,1,2,1,1,1}},
        {'B', new[] {1,2,1,1,1,2,1,1,1}},
        {'C', new[] {2,2,1,1,1,2,1,1,1}},
        {'D', new[] {1,1,2,1,1,2,1,1,1}},
        {'E', new[] {2,1,2,1,1,2,1,1,1}},
        {'F', new[] {1,2,2,1,1,2,1,1,1}},
        {'G', new[] {1,1,1,2,1,2,1,1,1}},
        {'H', new[] {2,1,1,2,1,2,1,1,1}},
        {'I', new[] {1,2,1,2,1,2,1,1,1}},
        {'J', new[] {1,1,2,2,1,2,1,1,1}},
        {'K', new[] {2,1,1,1,1,1,2,1,1}},
        {'L', new[] {1,2,1,1,1,1,2,1,1}},
        {'M', new[] {2,2,1,1,1,1,2,1,1}},
        {'N', new[] {1,1,2,1,1,1,2,1,1}},
        {'O', new[] {2,1,2,1,1,1,2,1,1}},
        {'P', new[] {1,2,2,1,1,1,2,1,1}},
        {'Q', new[] {1,1,1,2,1,1,2,1,1}},
        {'R', new[] {2,1,1,2,1,1,2,1,1}},
        {'S', new[] {1,2,1,2,1,1,2,1,1}},
        {'T', new[] {1,1,2,2,1,1,2,1,1}},
        {'U', new[] {2,1,1,1,1,1,1,2,1}},
        {'V', new[] {1,2,1,1,1,1,1,2,1}},
        {'W', new[] {2,2,1,1,1,1,1,2,1}},
        {'X', new[] {1,1,2,1,1,1,1,2,1}},
        {'Y', new[] {2,1,2,1,1,1,1,2,1}},
        {'Z', new[] {1,2,2,1,1,1,1,2,1}},
        {'-', new[] {1,1,1,2,1,1,1,2,1}},
        {'.', new[] {2,1,1,2,1,1,1,2,1}},
        {' ', new[] {1,2,1,2,1,1,1,2,1}},
        {'$', new[] {1,1,1,1,2,1,2,1,2}},
        {'/', new[] {1,1,1,2,1,2,1,1,2}},
        {'+', new[] {1,1,2,1,2,1,1,1,2}},
        {'%', new[] {1,2,1,1,2,1,2,1,1}},
        {'*', new[] {1,2,1,2,2,1,2,1,1}}
    };
}
